<!DOCTYPE html>
<html>
<head>
<style>
table {
    font-family: arial, sans-serif;
    border-collapse: collapse;
    width: 100%;
}

td, th {
    border: 2px solid #dddddd;
    text-align: left;
    padding: 8px;
}

tr:nth-child(even) td{
    background-color: #dddddd;
}
</style>
</head>
    <body>
        <table>
            <caption><h2>Win10 ZDI Lease Status Report: {{ report_current_time }}</h2></caption>
            <tr>
                <th>Name</th>
                <th>Start Date</th>
                <th>Expiration Date</th>
                <th>Remaining Hours</th>
                <th>Lease Period</th>
                <th>Owner</th>
                {% if list_all == 'true' %}
                <th>Note</th>
                <th>Owner Email</th>
                <th>Email CC</th>
                {% endif %}
            </tr>
            {% for myVdi in new_list|sort(attribute=sort_by)  %}
            <tr>
                <td>{{ myVdi.name }}</td>
                <td>{{ myVdi.lease_started }}</td>
                <td>{{ myVdi.expire}}</td>
                <td><SPAN>{{ myVdi.remaining_hours}}</SPAN></td>
                <td>{{ myVdi.lease_period }}</td>
                <td><SPAN>{{ myVdi.owner }}</SPAN></td>
                {% if list_all == 'true' %}
                <td>{{ myVdi.note}}</td>
                <td>{{ myVdi.email}}</td>
                <td>{{ myVdi.cc}}</td>
                {% endif %}
            </tr>
            {% endfor %}
        </table>
        <p><small>For {{tz_environment}}, generated by {{ tower_user_name  }} from Ansible Tower job {{ tower_job_id }}, and the table is sorted by {{ sort_by }}</small></p>
        <p>
        <small>ZDI name list: 
        {% for myVdi in new_list|sort(attribute=sort_by)  %}
        {{ myVdi.name }}
        {% if not loop.last %}
            ,
        {% endif %}
        {% endfor %}
        </small>
        </p>
        <p><small>Total VDIs: {{ new_list|length }} </small></p>
    </body>
</html>

